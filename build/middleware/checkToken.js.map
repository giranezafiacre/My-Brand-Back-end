{"version":3,"sources":["../../src/middleware/checkToken.js"],"names":["dotenv","config","checkToken","req","res","next","authorization","headers","status","json","error","verified","jwt","verify","process","env","MY_SECRET","tokenData"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AAEAA,mBAAOC,MAAP;;AACO,IAAMC,UAAU;AAAA,2FAAG,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AACdC,YAAAA,aADc,GACIH,GAAG,CAACI,OADR,CACdD,aADc;;AAAA,gBAEjBA,aAFiB;AAAA;AAAA;AAAA;;AAAA,6CAGXF,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBD,cAAAA,MAAM,EAAE,GADgB;AAExBE,cAAAA,KAAK,EAAE;AAFiB,aAArB,CAHW;;AAAA;AAAA;AASZC,YAAAA,QATY,GASDC,yBAAIC,MAAJ,CAAWP,aAAX,EAA0BQ,OAAO,CAACC,GAAR,CAAYC,SAAtC,CATC;AAUlBb,YAAAA,GAAG,CAACc,SAAJ,GAAgBN,QAAhB;;AAVkB,iBAWdR,GAAG,CAACc,SAXU;AAAA;AAAA;AAAA;;AAYdZ,YAAAA,IAAI;AAZU;AAAA;;AAAA;AAAA,6CAcPD,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBD,cAAAA,MAAM,EAAE,GADgB;AAExBE,cAAAA,KAAK,EAAE;AAFiB,aAArB,CAdO;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,6CAmBPN,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBD,cAAAA,MAAM,EAAE,GADgB;AAExBE,cAAAA,KAAK,EAAE;AAFiB,aAArB,CAnBO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAVR,UAAU;AAAA;AAAA;AAAA,GAAhB;;;eA0BQA,U","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport dotenv from 'dotenv';\r\n\r\ndotenv.config();\r\nexport const checkToken = async (req, res, next) => {\r\n    const { authorization } = req.headers;\r\n    if (!authorization) {\r\n        return res.status(401).json({\r\n            status: 401,\r\n            error: 'Token not provided',\r\n        });\r\n    } else {\r\n        try{\r\n        const verified = jwt.verify(authorization, process.env.MY_SECRET);\r\n        req.tokenData = verified;\r\n        if (req.tokenData) {\r\n            next();\r\n        } else {\r\n            return res.status(403).json({\r\n                status: 403,\r\n                error: 'You are not authorized to perform this task sign up first',\r\n            });\r\n        }}catch (error) {\r\n            return res.status(401).json({\r\n                status: 401,\r\n                error: 'You are not authorized to perform this task',\r\n            });\r\n        }\r\n    }\r\n};\r\nexport default checkToken;\r\n"],"file":"checkToken.js"}